(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     73543,       1922]
NotebookOptionsPosition[     67410,       1748]
NotebookOutlinePosition[     68000,       1771]
CellTagsIndexPosition[     67912,       1766]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.689173245517487*^9, 3.68917324553158*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]x", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]y", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q", "=", "2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Pi", "-", "flux"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmin", "=", 
   RowBox[{"-", "5"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ymin", "=", 
   RowBox[{"-", "5"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ymax", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTF", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rangeNeighbour", "=", " ", "0.6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]w", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k0", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "I", " ", "know", " ", "that", " ", "value", " ", "from", " ", 
    "experimental", " ", 
    RowBox[{"setup", ".", " ", "I"}], " ", "also", " ", "select", " ", "the", 
    " ", "energy", " ", "band", " ", "here", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"let", "'"}], "s", " ", "say", " ", "its", " ", "the", " ", 
       "lowest", " ", "energy", " ", "band"}], ")"}], ".", " ", "I"}], " ", 
    RowBox[{"don", "'"}], "t", " ", "know", " ", "the", " ", "tunneling", " ",
     "amplitude", " ", "ratio"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"J", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nIterations", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nRepeats", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nHIO", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gamma", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"npts", "=", "5"}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "points", " ", "in", " ", "the", " ", "1", "st", " ", "Brillouin", " ", 
    "zone"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.689177961807435*^9, 3.689177965981698*^9}, {
   3.689178029877137*^9, 3.689178033954275*^9}, {3.689259595849407*^9, 
   3.689259601394306*^9}, {3.6892597563751917`*^9, 3.689259761645096*^9}, {
   3.689260586395998*^9, 3.689260609127468*^9}, {3.68926073174002*^9, 
   3.6892607327509623`*^9}, {3.6892607633357277`*^9, 3.689260771577572*^9}, {
   3.689274255705721*^9, 3.689274279831793*^9}, {3.689275001417557*^9, 
   3.68927500278542*^9}, {3.689275097698125*^9, 3.6892750995668783`*^9}, {
   3.689275522443705*^9, 3.6892755225516987`*^9}, {3.689275567005932*^9, 
   3.689275581111896*^9}, {3.689275915922784*^9, 3.6892759171737556`*^9}, {
   3.689276151481575*^9, 3.689276157163251*^9}, {3.689276478263393*^9, 
   3.6892764871593*^9}, {3.6892777400130157`*^9, 3.6892777491474857`*^9}, {
   3.690134134083119*^9, 3.690134139423386*^9}, {3.6901364342662354`*^9, 
   3.690136443452573*^9}, {3.6901369137792664`*^9, 3.690136915490259*^9}, {
   3.690137199251897*^9, 3.690137213774098*^9}, {3.690137424075138*^9, 
   3.690137426006955*^9}, {3.690140973204207*^9, 3.690140974224534*^9}, {
   3.69014124936447*^9, 3.690141251498788*^9}, {3.690141405708593*^9, 
   3.6901414057707453`*^9}, {3.690142409223534*^9, 3.6901424104125137`*^9}, {
   3.690144115157136*^9, 3.6901441291923923`*^9}, {3.690144190359864*^9, 
   3.690144192068734*^9}, {3.690144370502193*^9, 3.690144371731123*^9}, {
   3.690145178829261*^9, 3.6901451941535892`*^9}, {3.690145381413962*^9, 
   3.690145383423032*^9}, {3.690355787008733*^9, 3.69035578919734*^9}, {
   3.6903561747069263`*^9, 3.69035617592339*^9}, {3.690358506383314*^9, 
   3.690358511085204*^9}, {3.6903589066381397`*^9, 3.69035890900196*^9}, {
   3.6903610157421227`*^9, 3.6903610173379307`*^9}, {3.690377304799773*^9, 
   3.69037730491466*^9}, {3.6903773744457483`*^9, 3.6903773772337093`*^9}, 
   3.690377459790752*^9, {3.690378725104746*^9, 3.690378725849889*^9}, {
   3.690379590736746*^9, 3.690379591440812*^9}, {3.69038311035238*^9, 
   3.690383111334559*^9}, {3.690383181678959*^9, 3.690383185916594*^9}, {
   3.690383292551734*^9, 3.690383305437608*^9}, {3.6904416202100973`*^9, 
   3.690441652192335*^9}, {3.6904419364538193`*^9, 3.690441961339601*^9}, 
   3.69044200081586*^9, {3.6904421830220127`*^9, 3.6904421965105057`*^9}, {
   3.690443954541964*^9, 3.690443956192935*^9}, {3.690445760737339*^9, 
   3.690445763343781*^9}, {3.690446264453158*^9, 3.690446264558659*^9}, {
   3.690447177359436*^9, 3.690447177434873*^9}, {3.690447269220911*^9, 
   3.690447300743861*^9}, {3.6904473367945023`*^9, 3.690447346820956*^9}, {
   3.690447507478587*^9, 3.690447509290764*^9}, {3.690448521228614*^9, 
   3.6904485235187073`*^9}, {3.690450227008464*^9, 3.6904502280769577`*^9}, {
   3.690450311898233*^9, 3.690450312195669*^9}, {3.690456415396016*^9, 
   3.690456446308489*^9}, {3.6904570360198717`*^9, 3.690457079270321*^9}, {
   3.690458813327845*^9, 3.690458821951082*^9}, {3.690461917339603*^9, 
   3.690461953760593*^9}, {3.690462556623157*^9, 3.690462558438876*^9}, {
   3.690462830670368*^9, 3.6904628882022247`*^9}, {3.690474875264744*^9, 
   3.690474880796914*^9}, {3.690477213245183*^9, 3.690477214917687*^9}, {
   3.690477635581675*^9, 3.690477635762652*^9}, {3.69047960894308*^9, 
   3.690479612562294*^9}, {3.69073762647563*^9, 3.690737642049315*^9}, {
   3.6907402326292133`*^9, 3.690740252055319*^9}, {3.690740654876648*^9, 
   3.69074065500331*^9}, 3.691164406807461*^9, {3.69116450672381*^9, 
   3.691164509840776*^9}, {3.691164597272889*^9, 3.691164598227974*^9}, {
   3.691166684961504*^9, 3.6911666990091543`*^9}, {3.691166929070509*^9, 
   3.6911669304986362`*^9}, 3.69116721097727*^9, 3.6911672906611643`*^9, {
   3.691169045131929*^9, 3.691169045859755*^9}, {3.691176420593718*^9, 
   3.691176429952394*^9}, {3.691241166359892*^9, 3.6912411723827953`*^9}, {
   3.691241356646072*^9, 3.6912413571531477`*^9}, {3.691241396806809*^9, 
   3.691241397306443*^9}, {3.6912570873924026`*^9, 3.6912570887844057`*^9}, {
   3.691257138381167*^9, 3.6912571394457493`*^9}, {3.691257272911477*^9, 
   3.691257273840447*^9}, {3.69125833858073*^9, 3.6912583390491123`*^9}, {
   3.691399268606097*^9, 3.691399280970413*^9}, {3.691399370422439*^9, 
   3.6913993729781923`*^9}, {3.691399446134865*^9, 3.691399446982012*^9}, {
   3.691399545331946*^9, 3.6913995462373867`*^9}, {3.692468406641799*^9, 
   3.692468417501807*^9}, {3.6924689335179987`*^9, 3.692468933642837*^9}, {
   3.692470711545426*^9, 3.692470714617961*^9}, {3.692547413609354*^9, 
   3.69254741493297*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<space.m\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.689173253000095*^9, 3.6891732542123003`*^9}, {
  3.689277940941043*^9, 3.6892779419893627`*^9}, {3.690445463930182*^9, 
  3.690445491064684*^9}, {3.6904588643799753`*^9, 3.6904588650527163`*^9}}],

Cell[BoxData[
 RowBox[{"?", "latticeProbingPoints"}]], "Input",
 CellChangeTimes->{{3.6891747238711433`*^9, 3.68917472571244*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lat", "=", 
   RowBox[{"latticeProbingPoints", "[", 
    RowBox[{
    "xmin", ",", "xmax", ",", "ymin", ",", "ymax", ",", "\[Delta]x", ",", 
     "\[Delta]y"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6891732615525208`*^9, 3.689173281808976*^9}, {
   3.689173756311905*^9, 3.689173764709388*^9}, {3.6891746658412724`*^9, 
   3.689174692563531*^9}, {3.689174820295598*^9, 3.689174822394309*^9}, {
   3.689175009953062*^9, 3.6891750133732224`*^9}, {3.689175364880353*^9, 
   3.689175376610848*^9}, {3.6891757446181993`*^9, 3.689175746801271*^9}, {
   3.689177936493342*^9, 3.689177951285228*^9}, {3.689276502620123*^9, 
   3.689276504062978*^9}, 3.6892776476794777`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "rectLatticeSites"}]], "Input",
 CellChangeTimes->{{3.689174731284721*^9, 3.6891747323963842`*^9}}],

Cell[BoxData[
 StyleBox["\<\"rectLatticeSites[ax, ay, RTF, latticeProbingPoints] generates \
a list: {{x_i,y_i},type_i} are the rectangular lattice sites, where type_i is \
the i-th lattice site type (-1 - type A or 1 - type B)\\\\n    \"\>", 
  "MSG"]], "Print", "PrintUsage",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.689275034044568*^9, {3.68927609072923*^9, 3.689276101756044*^9}},
 CellTags->"Info223689278633-5005130"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rec", "=", 
   RowBox[{"rectLatticeSites", "[", 
    RowBox[{
    "a", ",", "RTF", ",", " ", "xmin", ",", " ", "xmax", ",", " ", "ymin", 
     ",", " ", "ymax"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.689173286944474*^9, 3.689173302250079*^9}, {
   3.689173334060388*^9, 3.6891733519977207`*^9}, {3.689174009590005*^9, 
   3.689174010085178*^9}, {3.689174357664789*^9, 3.6891743577384853`*^9}, {
   3.689174539290514*^9, 3.689174571665874*^9}, 3.6891746794999027`*^9, {
   3.6891750251053743`*^9, 3.689175027989843*^9}, {3.68917797214892*^9, 
   3.6891779813920803`*^9}, 3.689260612478938*^9, {3.689274323355195*^9, 
   3.6892743317217712`*^9}, {3.689275112330977*^9, 3.689275113076831*^9}, {
   3.690138511600976*^9, 3.69013851410606*^9}}],

Cell[BoxData[
 RowBox[{"Dimensions", "@", "rec"}]], "Input",
 CellChangeTimes->{{3.6912572876776657`*^9, 3.691257290315082*^9}}],

Cell[BoxData[
 RowBox[{"Dimensions", "@", "neighpos"}]], "Input",
 CellChangeTimes->{{3.691257292664229*^9, 3.691257298618046*^9}, {
  3.691258369396166*^9, 3.691258379690555*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pos", "=", 
   RowBox[{"rectLatticeSitesPos", "[", 
    RowBox[{
    "lat", ",", "a", ",", " ", "\[Delta]x", ",", "\[Delta]y", ",", "RTF"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68927436104426*^9, 3.689274371641285*^9}, {
   3.689274421393882*^9, 3.689274446146263*^9}, {3.6892754011517487`*^9, 
   3.689275401536821*^9}, 3.68927554612185*^9, 3.690136601970977*^9, {
   3.690137595412162*^9, 3.690137597590166*^9}, 3.690140794151657*^9, {
   3.690379313816648*^9, 3.690379314821265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"neighpos", "=", 
   RowBox[{"rectLatticeSitesNeighbourhood", "[", 
    RowBox[{
    "pos", ",", "lat", ",", "\[Delta]x", ",", "\[Delta]y", ",", 
     "rangeNeighbour"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.689277495220203*^9, 3.689277533721768*^9}, 
   3.69014082968871*^9, 3.690141016597733*^9, {3.6901415671117573`*^9, 
   3.690141568489388*^9}, 3.690142398342825*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"recA", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", "rec"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6891753968398933`*^9, 3.68917549298333*^9}, {
  3.689175530044739*^9, 3.689175637258499*^9}, {3.690138592573083*^9, 
  3.69013859340417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"recB", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", "rec"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6891756210398817`*^9, 3.689175640515667*^9}, 
   3.6901385996965*^9}],

Cell[BoxData[
 RowBox[{"p1", "=", 
  RowBox[{"ListPlot", "[", "lat", "]"}]}]], "Input",
 CellChangeTimes->{{3.689174053049574*^9, 3.689174062489991*^9}, {
  3.689174242368238*^9, 3.689174244581595*^9}, {3.690140851019912*^9, 
  3.690140853358231*^9}, {3.690145019124381*^9, 3.69014502151873*^9}, {
  3.691241203724358*^9, 3.691241206508129*^9}}],

Cell[BoxData[
 RowBox[{"p2A", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"recA", ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "\[Rule]", "0.05"}], ",", "Green"}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.68917424917667*^9, 3.689174280836514*^9}, {
   3.689174337505459*^9, 3.689174340246044*^9}, {3.689174504853459*^9, 
   3.6891745168357077`*^9}, {3.689174634942891*^9, 3.689174639978944*^9}, 
   3.6891752990126333`*^9, 3.689175648577474*^9, {3.689175684963431*^9, 
   3.6891756875265903`*^9}, {3.690443820674596*^9, 3.690443822880526*^9}, {
   3.6912412074731007`*^9, 3.691241210874715*^9}}],

Cell[BoxData[
 RowBox[{"p2B", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"recB", ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "\[Rule]", "0.05"}], ",", "Red"}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.689175308498363*^9, 3.689175344235298*^9}, {
  3.6891756542911863`*^9, 3.689175655056098*^9}, {3.68917577010085*^9, 
  3.689175771184017*^9}, {3.69044382665348*^9, 3.6904438288124933`*^9}, {
  3.691241211987734*^9, 3.691241213596517*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pospos", "=", 
    RowBox[{"{", "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "coordinates", " ", "of", " ", "the", " ", "probing", " ", "points", " ", 
    "nearest", " ", "to", " ", "the", " ", "nodes"}], " ", "*)"}]}]], "Input",\

 CellChangeTimes->{{3.690137878251547*^9, 3.690137911918302*^9}, {
  3.690137953981229*^9, 3.690138034985845*^9}, {3.690138072629224*^9, 
  3.6901380822674103`*^9}, {3.690140901798635*^9, 3.690140925289188*^9}, {
  3.6904438368044662`*^9, 3.6904438393642063`*^9}, {3.691241214251308*^9, 
  3.691241216058445*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"pospos", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"pospos", ",", 
        RowBox[{"lat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "&"}]}], 
    ",", " ", "pos"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.690138084567033*^9, 3.690138116156331*^9}, {
  3.690138160491556*^9, 3.690138196856736*^9}, {3.690138300148506*^9, 
  3.690138329615655*^9}, {3.690138425443116*^9, 3.690138433135129*^9}, {
  3.690443841994253*^9, 3.690443844255628*^9}, {3.691241218259123*^9, 
  3.691241219625011*^9}}],

Cell[BoxData[
 RowBox[{"p4", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"pospos", ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"PointSize", "\[Rule]", "0.015"}], "}"}]}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.69013844589323*^9, 3.690138462156427*^9}, {
  3.690138672456826*^9, 3.690138703995386*^9}, {3.6904438467501287`*^9, 
  3.690443848862788*^9}, {3.69124122129642*^9, 3.691241222642177*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"neighpospos", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.690141104761031*^9, 3.6901411128950157`*^9}, {
  3.6904438519794693`*^9, 3.690443853960499*^9}, {3.691241223980514*^9, 
  3.691241225325444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"neighpospos", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"neighpospos", ",", 
        RowBox[{"lat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], "&"}]}], 
    ",", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{"neighpos", ",", "1"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.690141121666007*^9, 3.690141208857985*^9}, {
  3.6904438557926273`*^9, 3.6904438578922567`*^9}, {3.6912412265493526`*^9, 
  3.691241227936783*^9}}],

Cell[BoxData[
 RowBox[{"p5", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"neighpospos", ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"PointSize", "\[Rule]", "0.03"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6901411500042677`*^9, 3.6901411558071947`*^9}, {
  3.690141215395398*^9, 3.690141230891692*^9}, {3.690141587891713*^9, 
  3.690141587943207*^9}, {3.6904438598586617`*^9, 3.690443861776828*^9}, {
  3.691241229496332*^9, 3.6912412307629747`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", " ", 
  RowBox[{"p2A", ",", "p2B", ",", "p4", ",", "p5", ",", 
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"RTF", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "fi", "]"}], ",", 
        RowBox[{"Sin", "[", "fi", "]"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"fi", ",", "0", ",", 
       RowBox[{"2", "Pi"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.690138455970731*^9, 3.690138468629216*^9}, {
  3.690138646274086*^9, 3.6901386664927397`*^9}, {3.690138961950766*^9, 
  3.69013896793358*^9}, {3.69013948529202*^9, 3.69013949599961*^9}, {
  3.690141221979082*^9, 3.690141224172594*^9}, {3.690145026441012*^9, 
  3.690145028683378*^9}, {3.6912412324000998`*^9, 3.691241343130642*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<wavefunction.m\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.689177627551421*^9, 3.689177651398694*^9}, 
   3.689177763449984*^9, {3.690445477964065*^9, 3.690445486309873*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]", "=", 
   RowBox[{"wannierNormalisationFactor", "[", 
    RowBox[{"\[Sigma]w", ",", "\[Delta]x", ",", "\[Delta]y", ",", "lat"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68917778448046*^9, 3.689177812851482*^9}, {
   3.689178004681258*^9, 3.689178025383156*^9}, 3.68917816098531*^9, 
   3.689178203421454*^9, 3.690443867081403*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Plot3D", "[", 
   RowBox[{
    RowBox[{"wannier", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", "\[Sigma]w", ",", "\[Beta]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"-", "2"}], "\[Sigma]w"}], ",", 
      RowBox[{"2", "\[Sigma]w"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{
       RowBox[{"-", "2"}], "\[Sigma]w"}], ",", 
      RowBox[{"2", "\[Sigma]w"}]}], "}"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6891781647560873`*^9, 3.689178167997332*^9}, {
  3.689178274603146*^9, 3.6891783781796093`*^9}, {3.690442917724125*^9, 
  3.690442919998867*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"wavef", "=", 
   RowBox[{"waveFunctionHarper", "[", 
    RowBox[{
    "lat", ",", "a", ",", "J", ",", "J1", ",", "rec", ",", "RTF", ",", "k0", 
     ",", "\[Sigma]w", ",", "\[Beta]", ",", " ", "\[Delta]x", ",", " ", 
     "\[Delta]y"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.689259564101465*^9, 3.6892596267467537`*^9}, {
   3.689259724001521*^9, 3.689259750734791*^9}, 3.6892603323834867`*^9, 
   3.690143043556263*^9, {3.690446752627533*^9, 3.6904467569396276`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListPlot3D", "[", 
   RowBox[{"Abs", "@", "wavef"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.690358873945242*^9, 3.690358882229926*^9}, {
  3.690358958373371*^9, 3.690358959884405*^9}, {3.690359324296577*^9, 
  3.690359324890524*^9}, {3.69044351066882*^9, 3.6904435129273653`*^9}, {
  3.690443743696918*^9, 3.690443750697706*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListDensityPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"lat", ",", "1"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"lat", ",", "1"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"Abs", "@", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"wavef", ",", "1"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"lat", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<|\[Psi]|\>\""}], 
      "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.689260427870407*^9, 3.689260575243335*^9}, {
   3.6901437505358753`*^9, 3.690143753935376*^9}, {3.690143793319071*^9, 
   3.690143793910222*^9}, {3.69014397528188*^9, 3.690144071682311*^9}, 
   3.6901444998545113`*^9, {3.690145437510714*^9, 3.690145450447606*^9}, {
   3.6903555720559673`*^9, 3.690355584173522*^9}, {3.690355750172226*^9, 
   3.6903557509761477`*^9}, {3.690360969224148*^9, 3.6903609990800877`*^9}, {
   3.690361477283626*^9, 3.690361491034444*^9}, {3.6903772655407476`*^9, 
   3.690377290027561*^9}, {3.690379562453712*^9, 3.690379578611916*^9}, {
   3.69037962469811*^9, 3.690379627446999*^9}, {3.690379674460333*^9, 
   3.690379679761219*^9}, {3.6904435169191504`*^9, 3.690443520800315*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FTwavef", "=", 
   RowBox[{"Fourier", "[", "wavef", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6903569587619762`*^9, 3.690356972440338*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListPlot3D", "[", 
   RowBox[{
    RowBox[{"Abs", "@", 
     RowBox[{"mirror2DSpace", "[", "FTwavef", "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.690356979582078*^9, 3.69035701193559*^9}, {
  3.690361072890913*^9, 3.690361111326219*^9}, {3.6903613826102867`*^9, 
  3.690361400338285*^9}, {3.6903614499762383`*^9, 3.6903614618544397`*^9}, {
  3.690443526137795*^9, 3.6904435284818497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FTXAbs", "=", 
   RowBox[{"Abs", "@", 
    RowBox[{"Fourier", "[", "wavef", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6904417071383533`*^9, 3.690441723564088*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"wavefAbs", "=", 
   RowBox[{"Abs", "@", "wavef"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.690441732702736*^9, 3.690441742334059*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"support", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", "#", "]"}], "<", "RTF"}], ",", "1", ",", "0"}], 
       "]"}], "&"}], ",", "lat", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.690441746899242*^9, 3.6904418476344223`*^9}, {
  3.690441896887661*^9, 3.690441899001751*^9}}],

Cell[BoxData[
 RowBox[{"<<", "\"\<HIOER.m\>\""}]], "Input",
 CellChangeTimes->{{3.6904419296826563`*^9, 3.690441930965372*^9}, {
  3.690442065475816*^9, 3.690442087927567*^9}, {3.690442867953597*^9, 
  3.69044287291632*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"retr", "=", 
    RowBox[{"phaseRetrieveGuess", "[", 
     RowBox[{
     "FTXAbs", ",", "wavefAbs", ",", "support", ",", "nIterations", ",", 
      "nRepeats", ",", "nHIO", ",", "gamma"}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6904421368047857`*^9, 3.690442204806643*^9}, {
  3.691164326389818*^9, 3.691164335608424*^9}, {3.691400576037487*^9, 
  3.691400578151876*^9}, {3.692467276955213*^9, 3.692467280675591*^9}, {
  3.692467876976461*^9, 3.692467878763812*^9}, {3.6924698633784313`*^9, 
  3.692469866518876*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"retr", "=", 
   RowBox[{"phaseRetrieveSupport", "[", 
    RowBox[{
    "FTXAbs", ",", "support", ",", "nIterations", ",", "nRepeats", ",", 
     "nHIO", ",", "gamma"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.691164339771948*^9, {3.691164392020535*^9, 3.69116439322285*^9}, {
   3.691400571877903*^9, 3.691400574249446*^9}, {3.692467273593628*^9, 
   3.6924672874688663`*^9}, {3.692467880656543*^9, 3.6924678829088984`*^9}, {
   3.692469868963235*^9, 3.692469870857884*^9}}],

Cell[BoxData[
 RowBox[{"p6", "=", 
  RowBox[{"ListDensityPlot", "[", 
   RowBox[{
    RowBox[{"Arg", "@", "retr"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "Hue"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6904435337146997`*^9, 3.6904435526011868`*^9}, {
   3.6904437190406733`*^9, 3.690443728043956*^9}, {3.691399418121191*^9, 
   3.691399420237295*^9}, {3.691400779015333*^9, 3.691400780492909*^9}, {
   3.6924673560103817`*^9, 3.6924673894410048`*^9}, {3.692467428457881*^9, 
   3.6924674507383747`*^9}, {3.6924677149248877`*^9, 3.692467757425033*^9}, 
   3.692467787598518*^9, {3.692467823264785*^9, 3.692467826698978*^9}}],

Cell[BoxData[
 RowBox[{"p6rev", "=", 
  RowBox[{"ListDensityPlot", "[", 
   RowBox[{
    RowBox[{"Arg", "@", 
     RowBox[{"mirrorXY", "@", "retr"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "Hue"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.692467771173085*^9, 3.692467780330305*^9}, {
  3.692467836414669*^9, 3.692467839603109*^9}}],

Cell[BoxData[
 RowBox[{"p7", "=", 
  RowBox[{"ListDensityPlot", "[", 
   RowBox[{
    RowBox[{"Arg", "@", "wavef"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "Hue"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.690443758547082*^9, 3.690443770014803*^9}, {
  3.690447689112628*^9, 3.6904476966607323`*^9}, {3.6913994244003973`*^9, 
  3.691399428943645*^9}, {3.6914007850325813`*^9, 3.691400786295127*^9}, {
  3.692467362842338*^9, 3.692467364135722*^9}, {3.692467399594575*^9, 
  3.6924674236374483`*^9}, {3.6924674549991627`*^9, 3.692467455454135*^9}, {
  3.692468320712936*^9, 3.6924683266879187`*^9}}],

Cell[BoxData[
 RowBox[{"rec", "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6904456260598907`*^9, 3.690445627874277*^9}}],

Cell[BoxData[
 RowBox[{"\[Xi]", "=", 
  RowBox[{"1", "/", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"Total", "@", 
      RowBox[{"Total", "@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", "RTF", "]"}], ">", 
             RowBox[{"Norm", "[", "#", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", "RTF", "]"}], "^", "2"}], "-", 
             RowBox[{
              RowBox[{"Norm", "[", "#", "]"}], "^", "2"}]}], ",", "0"}], 
           "]"}], "&"}], ",", "lat", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], "*", "\[Delta]x", "*", 
     "\[Delta]y"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.690739196251729*^9, 3.6907392039554377`*^9}, {
  3.690739234051406*^9, 3.6907395112293453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ckModel", "=", 
   RowBox[{"wannierBaseRectProject", "[", 
    RowBox[{
    "wavef", ",", "lat", ",", "rec", ",", "pos", ",", "neighpos", ",", 
     "\[Sigma]w", ",", "\[Beta]", ",", "\[Delta]x", ",", "\[Delta]y", ",", 
     "RTF"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.690445268346325*^9, 3.690445364471469*^9}, {
  3.690446164656539*^9, 3.69044616474305*^9}, {3.6906232503470087`*^9, 
  3.690623251110347*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ckRetr", "=", 
   RowBox[{"wannierBaseRectProject", "[", 
    RowBox[{
    "retr", ",", "lat", ",", "rec", ",", "pos", ",", "neighpos", ",", 
     "\[Sigma]w", ",", "\[Beta]", ",", "\[Delta]x", ",", "\[Delta]y", ",", 
     "RTF"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.690445375996771*^9, 3.690445392327743*^9}, {
  3.6904461691522818`*^9, 3.690446169225401*^9}, {3.6906232574802427`*^9, 
  3.690623258182534*^9}, {3.691164517886842*^9, 3.6911645334281*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ckRetrRev", "=", 
   RowBox[{"wannierBaseRectProject", "[", 
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"Reverse", "[", "retr", "]"}], "]"}], ",", "2"}], "]"}], ",", 
     "lat", ",", "rec", ",", "pos", ",", "neighpos", ",", "\[Sigma]w", ",", 
     "\[Beta]", ",", "\[Delta]x", ",", "\[Delta]y", ",", "RTF"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.692467559025158*^9, 3.692467566569721*^9}, {
  3.692467611397251*^9, 3.692467679169878*^9}}],

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"Abs", "[", "ckRetr", "]"}], "^", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.690446575162468*^9, 3.690446584920306*^9}, {
  3.690447243664811*^9, 3.6904472457220993`*^9}, {3.690447381663562*^9, 
  3.690447382726081*^9}, {3.690448625566951*^9, 3.690448627335321*^9}, {
  3.690739151869072*^9, 3.690739154674013*^9}, {3.690739520201395*^9, 
  3.690739537663644*^9}, {3.690739637875647*^9, 3.690739638054188*^9}, {
  3.69074058511548*^9, 3.6907405856435833`*^9}, {3.692467620225523*^9, 
  3.692467624436907*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Conjugate", "[", "ckRetr", "]"}], ".", "ckModel"}], "]"}], "^", 
  "2"}]], "Input",
 CellChangeTimes->{{3.6904454030997057`*^9, 3.6904454091078444`*^9}, {
  3.690445699698654*^9, 3.690445730256281*^9}, {3.690445794846055*^9, 
  3.690445805555835*^9}, {3.690445843373929*^9, 3.690445843950007*^9}, {
  3.690446024473769*^9, 3.690446026113809*^9}, {3.69044607083775*^9, 
  3.69044613116686*^9}, {3.690446171802538*^9, 3.690446174628162*^9}, {
  3.690446925548052*^9, 3.69044693806168*^9}, {3.690447120921341*^9, 
  3.690447121255917*^9}, {3.692467629228405*^9, 3.692467629722698*^9}, {
  3.692468369961577*^9, 3.69246837047062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"guess", "[", 
    RowBox[{"J_", ",", "J1_", ",", " ", "ckModel_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"wavefJJ1", " ", "=", " ", 
       RowBox[{"waveFunctionHarper", "[", 
        RowBox[{
        "lat", ",", "a", ",", "J", ",", "J1", ",", "rec", ",", "RTF", ",", 
         "k0", ",", "\[Sigma]w", ",", "\[Beta]", ",", " ", "\[Delta]x", ",", 
         " ", "\[Delta]y"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"wannierBaseRectProject", "[", 
           RowBox[{
            RowBox[{"phaseRetrieveSupport", "[", 
             RowBox[{"FTXAbs", ",", 
              RowBox[{"Abs", "@", "wavefJJ1"}], ",", "support", ",", 
              "nIterations", ",", "nRepeats", ",", "nHIO", ",", "gamma", ",", 
              "RTF"}], "]"}], ",", "lat", ",", "rec", ",", "pos", ",", 
            "neighpos", ",", "\[Sigma]w", ",", "\[Beta]", ",", "\[Delta]x", 
            ",", "\[Delta]y", ",", "RTF"}], "]"}], "]"}], ".", "ckModel"}], 
        "]"}], "^", "2"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.690449730197901*^9, 3.6904501048438187`*^9}, {
  3.690450145687106*^9, 3.690450164408834*^9}, {3.690452341353903*^9, 
  3.690452342945355*^9}, {3.690623238333479*^9, 3.6906232391467533`*^9}, {
  3.690738731050063*^9, 3.690738732486731*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"guessT", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"J", ",", "J1", ",", 
       RowBox[{"guess", "[", 
        RowBox[{"J", ",", "J1", ",", "ckModel"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"J", ",", "0.33", ",", "2", ",", "0.33"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"J1", ",", "0.33", ",", "2", ",", "0.33"}], "}"}], ",", " ", 
     RowBox[{"DistributedContexts", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<space`\>\"", ",", "\"\<wavefunction`\>\"", ",", 
        "\"\<HIOER`\>\""}], "}"}]}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6904502493585453`*^9, 3.690450353511766*^9}, {
  3.69045040461656*^9, 3.690450416097217*^9}, {3.6904504529510317`*^9, 
  3.690450511593933*^9}, {3.690450641554529*^9, 3.690450649388484*^9}, {
  3.69045074674748*^9, 3.690450749564662*^9}, {3.690451449896784*^9, 
  3.6904515092464848`*^9}, {3.690451812828867*^9, 3.6904518168336782`*^9}, {
  3.690455061727552*^9, 3.690455063792942*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListPlot3D", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"guessT", ",", "1"}], "]"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.690450590952009*^9, 3.69045060142667*^9}, {
  3.6904510940839567`*^9, 3.6904511086001043`*^9}, {3.690455075663794*^9, 
  3.690455078863206*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"guess2", "[", 
   RowBox[{"J_", ",", "J1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"wavefJJ1", " ", "=", " ", 
      RowBox[{"waveFunctionHarper", "[", 
       RowBox[{
       "lat", ",", "a", ",", "J", ",", "J1", ",", "rec", ",", "RTF", ",", 
        "k0", ",", "\[Sigma]w", ",", "\[Beta]", ",", " ", "\[Delta]x", ",", 
        " ", "\[Delta]y"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"wavefJJ1", "=", 
      RowBox[{"phaseRetrieveSupport", "[", 
       RowBox[{"FTXAbs", ",", 
        RowBox[{"Abs", "@", "wavefJJ1"}], ",", "support", ",", "nIterations", 
        ",", "nRepeats", ",", "nHIO", ",", "gamma"}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "nie", " ", "ma", " ", "nic", " ", "wspolnego", " ", "z", " ", 
        "wavefJJ1"}], ",", " ", 
       RowBox[{
       "jest", " ", "to", " ", "obiekt", " ", "odzyskany", " ", "w", " ", 
        "tej", " ", "samej", " ", "pamieci"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Total", "@", 
       RowBox[{"Total", "@", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Fourier", "[", "wavefJJ1", "]"}], "]"}], "^", "2"}], "-", 
          RowBox[{
           RowBox[{"Abs", "[", "FTXAbs", "]"}], "^", "2"}]}], "]"}]}]}], "/", 
      
      RowBox[{"Total", "[", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"Abs", "[", "FTXAbs", "]"}], "^", "2"}], "]"}], "]"}]}]}]}], 
   " ", 
   RowBox[{"(*", 
    RowBox[{"metryka", " ", "bledu"}], "*)"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6904503360724297`*^9, 3.690450336189406*^9}, {
  3.690452229239739*^9, 3.69045225853693*^9}, {3.690452293341806*^9, 
  3.690452293797305*^9}, {3.690452365766656*^9, 3.690452528886895*^9}, {
  3.690452898526803*^9, 3.6904529021648912`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"guess2T", "=", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"J1", ",", 
       RowBox[{"guess2", "[", 
        RowBox[{"J", ",", "J1"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"J1", ",", "0.1", ",", "3", ",", "0.3"}], "}"}], ",", " ", 
     RowBox[{"DistributedContexts", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<space`\>\"", ",", "\"\<wavefunction`\>\"", ",", 
        "\"\<HIOER`\>\""}], "}"}]}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6904525892360086`*^9, 3.690452597251666*^9}, {
  3.690455069774612*^9, 3.6904550718122663`*^9}, {3.690456039577914*^9, 
  3.690456054578637*^9}, {3.690456139545082*^9, 3.690456139700963*^9}, {
  3.690456470238002*^9, 3.6904564793579073`*^9}, {3.690458533293824*^9, 
  3.690458535450067*^9}, {3.690477941239538*^9, 3.690477943222899*^9}, {
  3.690478011397112*^9, 3.690478015471867*^9}, {3.690740198173276*^9, 
  3.690740201910715*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"guess2T", ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<J1/J\>\"", ",", 
       "\"\<Niezgodnosc modulu tr. Fouriera zmierzonego z obliczonym z \
odzyskanej funkcji\>\""}], " ", "}"}]}]}], " ", "]"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.690452601777935*^9, {3.690455081820301*^9, 3.690455085092868*^9}, {
   3.690456113715438*^9, 3.6904561291241407`*^9}, {3.6904568245118637`*^9, 
   3.6904569318856077`*^9}, {3.6904569648532047`*^9, 3.690456983511718*^9}, {
   3.690458538837875*^9, 3.690458541624057*^9}, {3.690477952392926*^9, 
   3.690477954346512*^9}, {3.690740204236266*^9, 3.690740206539765*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"find", " ", "ckretr", " ", "for", " ", "kx"}], ",", 
    RowBox[{
    "ky", " ", "2", "d", " ", "table", " ", "of", " ", "1", "st", " ", 
     "BZ"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "find", " ", "Fxy", " ", "for", " ", "this", " ", "set", " ", "of", " ", 
    "ckretr"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"find", " ", "chern", " ", "number"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6904573059150057`*^9, 3.690457443845982*^9}}],

Cell[BoxData[
 RowBox[{"<<", "\"\<chernCalc.m\>\""}]], "Input",
 CellChangeTimes->{{3.690458943139176*^9, 3.6904589518338547`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BZ", "=", 
   RowBox[{"latticeProbingPointsBZ", "[", 
    RowBox[{"npts", ",", "a", ",", "q"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.690458615497963*^9, 3.6904586161006927`*^9}, {
  3.6904586766758127`*^9, 3.6904586800078487`*^9}, {3.690458785550528*^9, 
  3.690458831880192*^9}, {3.6904605061339817`*^9, 3.690460510229042*^9}, {
  3.690461912593029*^9, 3.690461913773678*^9}}],

Cell[BoxData[
 RowBox[{"Dimensions", "@", "BZ"}]], "Input",
 CellChangeTimes->{{3.692379594670965*^9, 3.6923795971711407`*^9}}],

Cell[BoxData["BZ"], "Input",
 CellChangeTimes->{{3.692379599941326*^9, 3.692379600123062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ckRetrBZ", "=", 
   RowBox[{"ParallelMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"findCkRetrSupport", "[", 
       RowBox[{
       "#", ",", "J", ",", "J1", ",", "lat", ",", "a", ",", "rec", ",", "RTF",
         ",", "support", ",", "nIterations", ",", "nRepeats", ",", "nHIO", 
        ",", "gamma", ",", "pos", ",", "neighpos", ",", "\[Sigma]w", ",", 
        "\[Beta]", ",", "\[Delta]x", ",", "\[Delta]y"}], "]"}], "&"}], ",", 
     "BZ", ",", 
     RowBox[{"{", "2", "}"}], ",", " ", 
     RowBox[{"DistributedContexts", "\[Rule]", "All"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.690458911847404*^9, 3.690459016722406*^9}, 
   3.6904590513125877`*^9, {3.690460518440831*^9, 3.6904605195677*^9}, {
   3.6924691941659327`*^9, 3.6924691993891172`*^9}, {3.692473352444779*^9, 
   3.6924733549966393`*^9}}],

Cell[BoxData[
 RowBox[{"ckRetrBZ", "[", 
  RowBox[{"[", 
   RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6911671672349043`*^9, 3.69116717368954*^9}, {
  3.6911676759822407`*^9, 3.6911677071795*^9}, {3.691169090673388*^9, 
  3.6911690927429047`*^9}}],

Cell[BoxData[
 RowBox[{"FxyTRetr", "=", 
  RowBox[{"FxyT", "[", 
   RowBox[{"ckRetrBZ", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", " ", "All", ",", "1"}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6904604877425337`*^9, 3.6904604911195498`*^9}, 
   3.6904608649349413`*^9, {3.6904613259824247`*^9, 3.690461330839293*^9}, {
   3.690478300570736*^9, 3.69047830428187*^9}, {3.691167422744834*^9, 
   3.691167459939259*^9}, {3.691167532497408*^9, 3.6911675335205507`*^9}, {
   3.691167563565384*^9, 3.6911675669847317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ckModelBZ", "=", 
   RowBox[{"ParallelMap", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"findCkModel", "[", 
       RowBox[{
       "#", ",", "J", ",", "J1", ",", "lat", ",", "a", ",", "rec", ",", "RTF",
         ",", "support", ",", "nIterations", ",", "nRepeats", ",", "nHIO", 
        ",", "gamma", ",", "pos", ",", "neighpos", ",", "\[Sigma]w", ",", 
        "\[Beta]", ",", "\[Delta]x", ",", "\[Delta]y"}], "]"}], "&"}], ",", 
     "BZ", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.690461093942418*^9, 3.690461097721508*^9}, {
   3.690461794976503*^9, 3.690461796742351*^9}, {3.691167117472937*^9, 
   3.6911671393938417`*^9}, 3.692379809351349*^9, 3.6924697226169558`*^9}],

Cell[BoxData[
 RowBox[{"Dimensions", "@", "ckModelBZ"}]], "Input",
 CellChangeTimes->{{3.69237994351824*^9, 3.6923799467937803`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ckModelBZ2", "=", 
   RowBox[{"ParallelMap", "[", 
    RowBox[{"Activate", ",", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Inactivate", "[", 
          RowBox[{"findCkModel", "[", 
           RowBox[{
           "#", ",", "J", ",", "J1", ",", "lat", ",", "a", ",", "rec", ",", 
            "RTF", ",", "support", ",", "nIterations", ",", "nRepeats", ",", 
            "nHIO", ",", "gamma", ",", "pos", ",", "neighpos", ",", 
            "\[Sigma]w", ",", "\[Beta]", ",", "\[Delta]x", ",", "\[Delta]y"}],
            "]"}], "]"}], "&"}], ",", "BZ", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
     RowBox[{"DistributedContexts", "\[Rule]", "All"}]}], "]"}]}], 
  "\n"}]], "Input",
 CellChangeTimes->{{3.692379636527611*^9, 3.692379636545573*^9}, {
  3.692379700513138*^9, 3.692379713282729*^9}, {3.692379966317233*^9, 
  3.692379990771225*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ckModelBZ3", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"ckModelBZ2", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"First", "@", 
        RowBox[{"Dimensions", "[", "BZ", "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Dimensions", "[", "BZ", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"Last", "@", 
        RowBox[{"Dimensions", "[", "ckModelBZ2", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.692380092441805*^9, 3.692380222229382*^9}}],

Cell[BoxData[
 RowBox[{"ckModelBZ3", "\[Equal]", "ckModelBZ"}]], "Input",
 CellChangeTimes->{{3.692380224639134*^9, 3.6923802320196037`*^9}}],

Cell[BoxData[
 RowBox[{"Dimensions", "@", "ckModelBZ2"}]], "Input",
 CellChangeTimes->{{3.6923800795250597`*^9, 3.692380082652649*^9}}],

Cell[BoxData[
 RowBox[{"Dimensions", "@", "ckModelBZ"}]], "Input",
 CellChangeTimes->{{3.691167148331183*^9, 3.691167162969193*^9}}],

Cell[BoxData[
 RowBox[{"FxyTModel", "=", 
  RowBox[{"FxyT", "[", "ckModelBZ", "]"}]}]], "Input",
 CellChangeTimes->{{3.690461349603341*^9, 3.690461358775332*^9}, 
   3.690462522350932*^9, {3.690478309084947*^9, 3.6904783214022818`*^9}, {
   3.691166893602662*^9, 3.691166895582343*^9}, {3.691167081656238*^9, 
   3.691167088502679*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ListPlot3D", "[", 
    RowBox[{
     RowBox[{"Im", "[", "FxyTRetr", "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "Hue"}]}], "]"}], ",", 
   RowBox[{"ListPlot3D", "[", 
    RowBox[{
     RowBox[{"Im", "[", "FxyTModel", "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "Hue"}]}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.690462567681386*^9, 3.690462679688575*^9}, {
  3.69116774688581*^9, 3.691167762348075*^9}, {3.6924697728541183`*^9, 
  3.692469803377962*^9}}],

Cell[BoxData[
 RowBox[{"w", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]"}], " ", ")"}]}], "*", 
    RowBox[{"Total", "@", 
     RowBox[{"Total", "[", "FxyTRetr", "]"}]}]}], "//", "Chop"}]}]], "Input",
 CellChangeTimes->{{3.6869439359856243`*^9, 3.6869440098393517`*^9}, {
   3.687003076687294*^9, 3.687003081807885*^9}, 3.687005689674142*^9, {
   3.687589802767839*^9, 3.6875898065343103`*^9}, {3.6875906190764093`*^9, 
   3.6875906438139*^9}, {3.687592995561595*^9, 3.68759299824772*^9}, {
   3.68760911019084*^9, 3.687609172556407*^9}, {3.6876106149532547`*^9, 
   3.6876106175558033`*^9}, 3.687610664283001*^9, {3.687611143388913*^9, 
   3.6876111795572233`*^9}, {3.687611276182809*^9, 3.687611278718067*^9}, {
   3.6876128598188353`*^9, 3.687612868152803*^9}, {3.687709942145105*^9, 
   3.6877099632970543`*^9}, {3.687710363676502*^9, 3.687710370633898*^9}, {
   3.6877105485559683`*^9, 3.687710564837255*^9}, {3.68771060769344*^9, 
   3.687710618397295*^9}, {3.687710661099923*^9, 3.6877107073437767`*^9}, {
   3.687710826872945*^9, 3.687710834702856*^9}, {3.687710879201358*^9, 
   3.6877110027164087`*^9}, {3.6877110327259007`*^9, 3.687711038915833*^9}, 
   3.687712183142592*^9, {3.687712238258745*^9, 3.6877122697174873`*^9}, {
   3.687712390748746*^9, 3.687712419530785*^9}, 3.687715447702993*^9, {
   3.687715920422114*^9, 3.6877159205223637`*^9}, {3.687720744963819*^9, 
   3.687720745120071*^9}, {3.687721233782051*^9, 3.687721237420539*^9}, {
   3.690461385214785*^9, 3.6904614293345823`*^9}, {3.691167782528154*^9, 
   3.691167782969997*^9}, 3.692471411592011*^9}],

Cell[BoxData[
 RowBox[{"w", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]"}], " ", ")"}]}], "*", 
    RowBox[{"Total", "@", 
     RowBox[{"Total", "[", "FxyTModel", "]"}]}]}], "//", "Chop"}]}]], "Input",\

 CellChangeTimes->{{3.690462096609583*^9, 3.690462097997882*^9}, {
  3.6911677889024267`*^9, 3.691167792680553*^9}}],

Cell[BoxData[
 RowBox[{"t1", "=", 
  RowBox[{"DateList", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.691169966949277*^9, 3.691169982525723*^9}}],

Cell[BoxData[
 RowBox[{"t2", "=", 
  RowBox[{"DateList", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.6911699852937527`*^9, 3.691169991141721*^9}}],

Cell[BoxData[
 RowBox[{"ToString", "[", 
  RowBox[{"t2", "-", "t1"}], "]"}]], "Input",
 CellChangeTimes->{{3.691169996477449*^9, 3.691169998919984*^9}, {
  3.691170071467558*^9, 3.691170076829281*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"guess3", "[", "kGuess_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wavefkGuess", "=", 
      RowBox[{"waveFunctionHarper", "[", 
       RowBox[{
       "lat", ",", "a", ",", "J", ",", "J1", ",", "rec", ",", "RTF", ",", 
        "kGuess", ",", "\[Sigma]w", ",", "\[Beta]", ",", "\[Delta]x", ",", 
        "\[Delta]y"}], "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"wavefkGuess", "=", 
      RowBox[{"phaseRetrieveGuess", "[", 
       RowBox[{"FTXAbs", ",", 
        RowBox[{"Abs", "@", "wavefkGuess"}], ",", "support", ",", 
        "nIterations", ",", "nRepeats", ",", "nHIO", ",", "gamma"}], "]"}]}], 
     ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "nie", " ", "ma", " ", "nic", " ", "wspolnego", " ", "z", " ", 
        "wavefkGuess"}], ",", 
       RowBox[{
       "jest", " ", "to", " ", "obiekt", " ", "odzyskany", " ", "w", " ", 
        "tej", " ", "samej", " ", "pamieci"}]}], "*)"}], 
     RowBox[{
      RowBox[{"Total", "@", 
       RowBox[{"Total", "@", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Fourier", "[", "wavefkGuess", "]"}], "]"}], "^", "2"}], 
          "-", 
          RowBox[{
           RowBox[{"Abs", "[", "FTXAbs", "]"}], "^", "2"}]}], "]"}]}]}], "/", 
      
      RowBox[{"Total", "[", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"Abs", "[", "FTXAbs", "]"}], "^", "2"}], "]"}], "]"}]}]}]}], 
   " ", 
   RowBox[{"(*", 
    RowBox[{"metryka", " ", "bledu"}], "*)"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.691176395049498*^9, 3.691176397027203*^9}, {
  3.691176445452107*^9, 3.691176453323749*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"guess3T", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kxGuess", ",", "kyGuess", ",", 
        RowBox[{"guess3", "[", 
         RowBox[{"{", 
          RowBox[{"kxGuess", ",", "kyGuess"}], "}"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kxGuess", ",", 
        RowBox[{
         RowBox[{"-", "2"}], 
         RowBox[{"Pi", "/", "a"}]}], ",", 
        RowBox[{"2", 
         RowBox[{"Pi", "/", "a"}]}], ",", "0.3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kyGuess", ",", 
        RowBox[{
         RowBox[{"-", "2"}], 
         RowBox[{"Pi", "/", "a"}]}], ",", 
        RowBox[{"2", 
         RowBox[{"Pi", "/", "a"}]}], ",", "0.3"}], "}"}], ",", 
      RowBox[{"DistributedContexts", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<space`\>\"", ",", "\"\<wavefunction`\>\"", ",", 
         "\"\<HIOER`\>\""}], "}"}]}]}], "]"}]}], ";"}], "\n"}]], "Input",
 CellChangeTimes->{{3.691176487337037*^9, 3.691176522914432*^9}}],

Cell[BoxData[
 RowBox[{"Dimensions", "@", 
  RowBox[{"Flatten", "[", 
   RowBox[{"guess3T", ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.691176654806965*^9, 3.691176671425342*^9}, {
  3.691176816590601*^9, 3.691176836464155*^9}, {3.6911768754105453`*^9, 
  3.691176879361516*^9}}],

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"guess3T", ",", "1"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"ListPointPlot3D", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "5", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "4"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6911768960117207`*^9, 3.6911769442829857`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"guess3T", ",", "1"}], "]"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<kx\>\"", ",", "\"\<ky\>\"", ",", " ", "\"\<1-error\>\""}], 
     "}"}]}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "Hue"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.691176688068617*^9, 3.6911766887923613`*^9}, {
  3.691176762287339*^9, 3.6911767948920727`*^9}, {3.691176845210387*^9, 
  3.6911768872423553`*^9}, {3.691176973602481*^9, 3.691177029443956*^9}, {
  3.6911770816654673`*^9, 3.691177087604107*^9}, {3.6911864193680058`*^9, 
  3.691186450039063*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.69117702715753*^9, 3.691177027175468*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"kGuess", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\</home/c8888/IdeaProjects/ChernRetrieval/out/kGuessData.dat\>\"", 
     ",", "\"\<Table\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6912597975715427`*^9, 3.691259859593133*^9}, 
   3.691259930390994*^9, {3.691259963233684*^9, 3.691259966063039*^9}, {
   3.691260090085556*^9, 3.691260109514785*^9}}],

Cell[BoxData[
 RowBox[{"Last", "@", "kGuess"}]], "Input",
 CellChangeTimes->{{3.691259847925055*^9, 3.691259855025523*^9}, {
  3.691259902417068*^9, 3.691259925346552*^9}, {3.691259970670534*^9, 
  3.6912599734676313`*^9}, {3.6912602267563562`*^9, 3.691260227369781*^9}}],

Cell[BoxData[
 RowBox[{"kGuess", "[", 
  RowBox[{"[", "4", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.691260114921382*^9, 3.691260124104909*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{"kGuess", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<kx\>\"", ",", "\"\<ky\>\"", ",", "\"\<error\>\""}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.691259838941145*^9, 3.691259844326249*^9}, {
  3.691259890871644*^9, 3.6912598910848637`*^9}, {3.6912599786853647`*^9, 
  3.691259979013673*^9}, {3.691260170242341*^9, 3.691260217532896*^9}, {
  3.691260257690165*^9, 3.691260258701213*^9}, {3.691261542302041*^9, 
  3.691261564197811*^9}}],

Cell[BoxData[
 RowBox[{"tab", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"1", "+", "I"}], ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", 
      RowBox[{"4", "+", 
       RowBox[{"9", "I"}]}], ",", 
      RowBox[{"2", "I"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.691407017771977*^9, 3.691407043182982*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Abs", "[", "tab", "]"}], " ", "*", " ", 
  RowBox[{"Exp", "[", 
   RowBox[{"I", " ", 
    RowBox[{"Arg", "[", 
     RowBox[{"tab", "*", "1."}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.691407050230624*^9, 3.6914070859856873`*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"RandomVariate", "[", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"x", ",", "0.01"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.691407218132709*^9, 3.691407249571826*^9}, {
  3.691407318313155*^9, 3.69140734607161*^9}}],

Cell[BoxData["RandomVa"], "Input",
 CellChangeTimes->{{3.6914072544748173`*^9, 3.6914072581078033`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]PhNoiseMin", "=", "0.001"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]PhNoiseMax", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]PhNoiseMult", "=", "2"}], ";"}]}], "Input",
 CellChangeTimes->{{3.691408598835565*^9, 3.691408641808815*^9}, {
  3.691408675015944*^9, 3.6914086777159557`*^9}}],

Cell[BoxData[
 RowBox[{"\[Sigma]PhNoise", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"\[Sigma]PhNoiseMin", "*", 
     RowBox[{"\[Sigma]PhNoiseMult", "^", "i"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      RowBox[{
       RowBox[{"Round", "@", 
        RowBox[{"Log", "[", 
         RowBox[{"\[Sigma]PhNoiseMax", "/", "\[Sigma]PhNoiseMin"}], "]"}]}], 
       "/", 
       RowBox[{"Log", "[", "\[Sigma]PhNoiseMult", "]"}]}]}], " ", "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.691408588857807*^9, 3.6914085888663597`*^9}, {
  3.6914086596128263`*^9, 3.6914086652478724`*^9}}],

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6914093580024157`*^9, 3.691409379066474*^9}}],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"RandomVariate", "[", 
     RowBox[{"NormalDistribution", "[", 
      RowBox[{
       RowBox[{"Arg", "[", "#", "]"}], ",", "1"}], "]"}], "]"}], "&"}], ",", 
   "wavef", ",", 
   RowBox[{"{", "2", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.691409741476664*^9, 3.691409791944861*^9}}],

Cell[BoxData[
 RowBox[{"h", "=", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.692383609733089*^9, 3.692383656019771*^9}, {
  3.6923839060775642`*^9, 3.692383919198558*^9}}],

Cell[BoxData[
 RowBox[{"i", "=", 
  RowBox[{"N", "@", 
   RowBox[{
    RowBox[{"CoordinateTransformData", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "\[Rule]", "\"\<Spherical\>\""}], ",", 
      "\"\<Mapping\>\"", ",", "h"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", "3"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.69238361881588*^9, 3.692383623204982*^9}, {
  3.692383663998105*^9, 3.692383666708091*^9}, {3.692383890574685*^9, 
  3.6923838955221443`*^9}, {3.6923839392624273`*^9, 3.692383955223329*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ArcCos", "[", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "/", 
      RowBox[{"Norm", "[", "h", "]"}]}], "]"}], ",", 
    RowBox[{"(*", "theta", "*)"}], 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"h", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", 
   RowBox[{"(*", "phi", "*)"}], "}"}], "\[Equal]", "i"}]], "Input",
 CellChangeTimes->{{3.6923838529743977`*^9, 3.692383899192686*^9}, {
  3.692383958630835*^9, 3.692383965393065*^9}}],

Cell[CellGroupData[{

Cell["Fxy", "Subchapter",
 CellChangeTimes->{{3.6925253629617023`*^9, 3.6925253637281017`*^9}}],

Cell[CellGroupData[{

Cell["Model", "Section",
 CellChangeTimes->{{3.6925254514142017`*^9, 3.692525451886195*^9}}],

Cell[CellGroupData[{

Cell["Model, npts=5", "Subsubsection",
 CellChangeTimes->{{3.692525368268771*^9, 3.692525372904015*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FxyTModel", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\</home/c8888/IdeaProjects/ChernRetrieval/out/FxyTModel.dat\>\"", 
      ",", "\"\<Table\>\""}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6924358031415358`*^9, 3.6924358083981953`*^9}, {
  3.692435899183174*^9, 3.69243592866783*^9}, {3.692443934848755*^9, 
  3.6924439350502462`*^9}, {3.6924440661656437`*^9, 3.692444090284481*^9}, {
  3.692512015533597*^9, 3.692512018276881*^9}, {3.692512940175632*^9, 
  3.692512979030918*^9}, {3.692525329976807*^9, 3.692525341393359*^9}, {
  3.692525385968136*^9, 3.6925253860998697`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Im", "@", "FxyTModel"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.692435816748878*^9, 3.6924358628764267`*^9}, {
   3.692435948203371*^9, 3.692435949071604*^9}, 3.6925253441396503`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], "/", "Pi"}], "/", "I"}], "*", 
  RowBox[{"Total", "@", 
   RowBox[{"Total", "@", "FxyTModel"}]}]}]], "Input",
 CellChangeTimes->{{3.692443878111279*^9, 3.692443917710205*^9}, 
   3.692525352235999*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model, npts=12", "Subsection",
 CellChangeTimes->{{3.6925253791008873`*^9, 3.6925253837500763`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FxyTModel", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\</home/c8888/IdeaProjects/ChernRetrieval/out/FxyTModel12.dat\>\"", 
      ",", "\"\<Table\>\""}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6924358031415358`*^9, 3.6924358083981953`*^9}, {
  3.692435899183174*^9, 3.69243592866783*^9}, {3.692443934848755*^9, 
  3.6924439350502462`*^9}, {3.6924440661656437`*^9, 3.692444090284481*^9}, {
  3.692512015533597*^9, 3.692512018276881*^9}, {3.692512940175632*^9, 
  3.692512979030918*^9}, {3.692525329976807*^9, 3.692525341393359*^9}, {
  3.692525385968136*^9, 3.6925253860998697`*^9}, {3.69252543339143*^9, 
  3.692525433469697*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Im", "@", "FxyTModel"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.692435816748878*^9, 3.6924358628764267`*^9}, {
   3.692435948203371*^9, 3.692435949071604*^9}, 3.6925253441396503`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], "/", "Pi"}], "/", "I"}], "*", 
  RowBox[{"Total", "@", 
   RowBox[{"Total", "@", "FxyTModel"}]}]}]], "Input"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["RetrSupport", "Section",
 CellChangeTimes->{{3.69252544297941*^9, 3.692525443477666*^9}, {
  3.692525506862588*^9, 3.692525507795475*^9}}],

Cell[CellGroupData[{

Cell["npts=5, iter=1000, repeats=3", "Subsubsection",
 CellChangeTimes->{{3.692525286737686*^9, 3.692525317658396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FxyTRetrSupport", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\</home/c8888/IdeaProjects/ChernRetrieval/out/27017FxyTRetrSupport.\
dat\>\"", ",", "\"\<Table\>\""}], "]"}]}]}], ";", 
  RowBox[{"ListPlot3D", "[", 
   RowBox[{
    RowBox[{"Im", "@", "FxyTRetrSupport"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.692435816748878*^9, 3.6924358628764267`*^9}, {
  3.692435948203371*^9, 3.692435949071604*^9}, {3.692525265871797*^9, 
  3.692525272128921*^9}, {3.6925254022621927`*^9, 3.692525407962225*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], "/", "Pi"}], "/", "I"}], "*", 
  RowBox[{"Total", "@", 
   RowBox[{"Total", "@", "FxyTModel2"}]}]}]], "Input",
 CellChangeTimes->{{3.692443878111279*^9, 3.692443917710205*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Retr, npts=5, iter=2000, repeats=6", "Subsection",
 CellChangeTimes->{{3.6925254664360857`*^9, 3.692525488323525*^9}}],

Cell[BoxData[
 RowBox[{"FxyTModel", "=", 
  RowBox[{"ToExpression", "@", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\</home/c8888/IdeaProjects/ChernRetrieval/out/29431FxyTRetrSupport.dat\
\>\"", ",", "\"\<Table\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6924358031415358`*^9, 3.6924358083981953`*^9}, {
  3.692435899183174*^9, 3.69243592866783*^9}, {3.692443934848755*^9, 
  3.6924439350502462`*^9}, {3.6924440661656437`*^9, 3.692444090284481*^9}, {
  3.692512015533597*^9, 3.692512018276881*^9}, {3.692512940175632*^9, 
  3.692512979030918*^9}, {3.692525490937182*^9, 3.692525496916917*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Im", "@", "FxyTModel"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.692435816748878*^9, 3.6924358628764267`*^9}, {
   3.692435948203371*^9, 3.692435949071604*^9}, 3.69252550281118*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], "/", "Pi"}], "/", "I"}], "*", 
  RowBox[{"Total", "@", 
   RowBox[{"Total", "@", "FxyTModel"}]}]}]], "Input",
 CellChangeTimes->{{3.692443878111279*^9, 3.692443917710205*^9}, 
   3.692525523577775*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Retr, npts=12, iter=1000, repeats=3", "Subsection",
 CellChangeTimes->{{3.6925254664360857`*^9, 3.692525488323525*^9}, {
  3.6925255387184277`*^9, 3.692525544158246*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FxyTModel", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\</home/c8888/IdeaProjects/ChernRetrieval/out/28288FxyTRetrSupport.\
dat\>\"", ",", "\"\<Table\>\""}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6924358031415358`*^9, 3.6924358083981953`*^9}, {
  3.692435899183174*^9, 3.69243592866783*^9}, {3.692443934848755*^9, 
  3.6924439350502462`*^9}, {3.6924440661656437`*^9, 3.692444090284481*^9}, {
  3.692512015533597*^9, 3.692512018276881*^9}, {3.692512940175632*^9, 
  3.692512979030918*^9}, {3.692525490937182*^9, 3.692525496916917*^9}, {
  3.6925255489609957`*^9, 3.692525557912787*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Im", "@", "FxyTModel"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.692435816748878*^9, 3.6924358628764267`*^9}, {
   3.692435948203371*^9, 3.692435949071604*^9}, 3.69252550281118*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], "/", "Pi"}], "/", "I"}], "*", 
  RowBox[{"Total", "@", 
   RowBox[{"Total", "@", "FxyTModel"}]}]}]], "Input",
 CellChangeTimes->{{3.692443878111279*^9, 3.692443917710205*^9}, 
   3.692525523577775*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Retr, npts=8, iter=1000, repeats=3", "Subsection",
 CellChangeTimes->{{3.6925254664360857`*^9, 3.692525488323525*^9}, {
  3.6925255387184277`*^9, 3.692525544158246*^9}, {3.6925255855600233`*^9, 
  3.692525585930133*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FxyTModel", "=", 
   RowBox[{"ToExpression", "@", 
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\</home/c8888/IdeaProjects/ChernRetrieval/out/27905FxyTRetrSupport.\
dat\>\"", ",", "\"\<Table\>\""}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6924358031415358`*^9, 3.6924358083981953`*^9}, {
  3.692435899183174*^9, 3.69243592866783*^9}, {3.692443934848755*^9, 
  3.6924439350502462`*^9}, {3.6924440661656437`*^9, 3.692444090284481*^9}, {
  3.692512015533597*^9, 3.692512018276881*^9}, {3.692512940175632*^9, 
  3.692512979030918*^9}, {3.692525490937182*^9, 3.692525496916917*^9}, {
  3.6925255489609957`*^9, 3.692525557912787*^9}, {3.692525597643799*^9, 
  3.692525599285593*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"Im", "@", "FxyTModel"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.692435816748878*^9, 3.6924358628764267`*^9}, {
   3.692435948203371*^9, 3.692435949071604*^9}, 3.69252550281118*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], "/", "Pi"}], "/", "I"}], "*", 
  RowBox[{"Total", "@", 
   RowBox[{"Total", "@", "FxyTModel"}]}]}]], "Input",
 CellChangeTimes->{{3.692443878111279*^9, 3.692443917710205*^9}, 
   3.692525523577775*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["hamiltonian verify", "Chapter",
 CellChangeTimes->{{3.692547465847039*^9, 3.69254747169331*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"h1", ",", "h2"}], "}"}], "=", 
  RowBox[{"N", "@", 
   RowBox[{"hamiltonianHarperK", "[", 
    RowBox[{"k0", ",", "J", ",", "J1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6925475039626493`*^9, 3.692547552312516*^9}, {
  3.69254761273916*^9, 3.692547621858796*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"theta", ",", "phi"}], "}"}], "=", 
  RowBox[{"blochSphereAnglesHarper", "[", 
   RowBox[{"k0", ",", "J", ",", "J1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6925475700072947`*^9, 3.692547608243299*^9}}],

Cell[BoxData[
 RowBox[{"Sin", "[", 
  RowBox[{"theta", "/", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.692547643628366*^9, 3.692547648000252*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h2", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "/", 
  RowBox[{"h2", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.692547655215996*^9, 3.6925477197573757`*^9}, {
  3.6925477562606564`*^9, 3.692547790214498*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tan", "[", 
   RowBox[{"theta", "/", "2"}], "]"}], "/", 
  RowBox[{"Exp", "[", 
   RowBox[{"I", " ", "phi"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.692547725329772*^9, 3.6925477413066893`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mod", "[", 
   RowBox[{"i", ",", "3"}], "]"}], "/.", 
  RowBox[{"i", "\[Rule]", "8"}]}]], "Input",
 CellChangeTimes->{{3.693206413189007*^9, 3.693206435365821*^9}}]
}, Open  ]]
},
WindowSize->{960, 983},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
WindowStatusArea->"Debug.nb last backed up to Debug.nb~ on Thu 12 Jan 2017 at \
11:40:26 AM",
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info223689278633-5005130"->{
  Cell[8834, 182, 456, 9, 60, "Print",
   CellTags->"Info223689278633-5005130"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info223689278633-5005130", 67807, 1760}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 169, 3, 32, "Input"],
Cell[730, 25, 6804, 123, 470, "Input"],
Cell[7537, 150, 295, 5, 34, "Input"],
Cell[7835, 157, 130, 2, 32, "Input"],
Cell[7968, 161, 711, 13, 34, "Input"],
Cell[CellGroupData[{
Cell[8704, 178, 127, 2, 32, "Input"],
Cell[8834, 182, 456, 9, 60, "Print",
 CellTags->"Info223689278633-5005130"]
}, Open  ]],
Cell[9305, 194, 785, 14, 34, "Input"],
Cell[10093, 210, 128, 2, 32, "Input"],
Cell[10224, 214, 180, 3, 32, "Input"],
Cell[10407, 219, 538, 11, 34, "Input"],
Cell[10948, 232, 417, 9, 34, "Input"],
Cell[11368, 243, 570, 17, 34, "Input"],
Cell[11941, 262, 473, 15, 34, "Input"],
Cell[12417, 279, 345, 6, 32, "Input"],
Cell[12765, 287, 718, 14, 34, "Input"],
Cell[13486, 303, 564, 12, 34, "Input"],
Cell[14053, 317, 607, 14, 34, "Input"],
Cell[14663, 333, 831, 22, 34, "Input"],
Cell[15497, 357, 436, 10, 34, "Input"],
Cell[15936, 369, 264, 6, 34, "Input"],
Cell[16203, 377, 770, 22, 57, "Input"],
Cell[16976, 401, 495, 10, 34, "Input"],
Cell[17474, 413, 828, 18, 34, "Input"],
Cell[18305, 433, 222, 4, 34, "Input"],
Cell[18530, 439, 387, 8, 34, "Input"],
Cell[18920, 449, 786, 23, 34, "Input"],
Cell[19709, 474, 513, 10, 34, "Input"],
Cell[20225, 486, 378, 7, 32, "Input"],
Cell[20606, 495, 1971, 44, 79, "Input"],
Cell[22580, 541, 180, 4, 34, "Input"],
Cell[22763, 547, 565, 12, 34, "Input"],
Cell[23331, 561, 206, 5, 34, "Input"],
Cell[23540, 568, 170, 4, 34, "Input"],
Cell[23713, 574, 453, 13, 34, "Input"],
Cell[24169, 589, 224, 4, 32, "Input"],
Cell[24396, 595, 589, 13, 34, "Input"],
Cell[24988, 610, 519, 11, 34, "Input"],
Cell[25510, 623, 686, 12, 34, "Input"],
Cell[26199, 637, 393, 9, 34, "Input"],
Cell[26595, 648, 658, 12, 34, "Input"],
Cell[27256, 662, 147, 3, 32, "Input"],
Cell[27406, 667, 875, 24, 34, "Input"],
Cell[28284, 693, 459, 10, 34, "Input"],
Cell[28746, 705, 504, 10, 34, "Input"],
Cell[29253, 717, 553, 13, 57, "Input"],
Cell[29809, 732, 572, 10, 32, "Input"],
Cell[30384, 744, 702, 13, 32, "Input"],
Cell[31089, 759, 1585, 34, 214, "Input"],
Cell[32677, 795, 1063, 23, 57, "Input"],
Cell[33743, 820, 320, 7, 34, "Input"],
Cell[34066, 829, 2023, 51, 192, "Input"],
Cell[36092, 882, 997, 22, 57, "Input"],
Cell[37092, 906, 721, 15, 57, "Input"],
Cell[37816, 923, 579, 14, 78, "Input"],
Cell[38398, 939, 131, 2, 32, "Input"],
Cell[38532, 943, 423, 8, 34, "Input"],
Cell[38958, 953, 127, 2, 32, "Input"],
Cell[39088, 957, 94, 1, 32, "Input"],
Cell[39185, 960, 863, 19, 79, "Input"],
Cell[40051, 981, 289, 6, 34, "Input"],
Cell[40343, 989, 542, 11, 34, "Input"],
Cell[40888, 1002, 758, 16, 79, "Input"],
Cell[41649, 1020, 133, 2, 32, "Input"],
Cell[41785, 1024, 956, 22, 168, "Input"],
Cell[42744, 1048, 557, 15, 57, "Input"],
Cell[43304, 1065, 141, 2, 32, "Input"],
Cell[43448, 1069, 135, 2, 32, "Input"],
Cell[43586, 1073, 132, 2, 32, "Input"],
Cell[43721, 1077, 336, 6, 32, "Input"],
Cell[44060, 1085, 638, 15, 57, "Input"],
Cell[44701, 1102, 1654, 27, 32, "Input"],
Cell[46358, 1131, 395, 11, 32, "Input"],
Cell[46756, 1144, 146, 3, 32, "Input"],
Cell[46905, 1149, 148, 3, 32, "Input"],
Cell[47056, 1154, 201, 4, 32, "Input"],
Cell[47260, 1160, 1729, 47, 124, "Input"],
Cell[48992, 1209, 1055, 30, 79, "Input"],
Cell[50050, 1241, 288, 6, 34, "Input"],
Cell[50341, 1249, 89, 2, 34, "Input"],
Cell[50433, 1253, 378, 10, 34, "Input"],
Cell[50814, 1265, 666, 14, 34, "Input"],
Cell[51483, 1281, 91, 1, 32, "Input"],
Cell[51577, 1284, 409, 9, 34, "Input"],
Cell[51989, 1295, 271, 4, 32, "Input"],
Cell[52263, 1301, 148, 3, 32, "Input"],
Cell[52414, 1306, 538, 11, 34, "Input"],
Cell[52955, 1319, 385, 12, 34, "Input"],
Cell[53343, 1333, 274, 7, 32, "Input"],
Cell[53620, 1342, 370, 9, 34, "Input"],
Cell[53993, 1353, 104, 1, 32, "Input"],
Cell[54100, 1356, 364, 9, 80, "Input"],
Cell[54467, 1367, 616, 16, 57, "Input"],
Cell[55086, 1385, 322, 9, 34, "Input"],
Cell[55411, 1396, 358, 10, 34, "Input"],
Cell[55772, 1408, 223, 5, 34, "Input"],
Cell[55998, 1415, 540, 12, 34, "Input"],
Cell[56541, 1429, 631, 18, 34, "Input"],
Cell[CellGroupData[{
Cell[57197, 1451, 95, 1, 64, "Subchapter"],
Cell[CellGroupData[{
Cell[57317, 1456, 92, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[57434, 1461, 104, 1, 35, "Subsubsection"],
Cell[57541, 1464, 672, 13, 34, "Input"],
Cell[58216, 1479, 301, 6, 34, "Input"],
Cell[58520, 1487, 277, 8, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58834, 1500, 106, 1, 45, "Subsection"],
Cell[58943, 1503, 722, 14, 57, "Input"],
Cell[59668, 1519, 301, 6, 34, "Input"],
Cell[59972, 1527, 185, 6, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60206, 1539, 144, 2, 65, "Section"],
Cell[CellGroupData[{
Cell[60375, 1545, 119, 1, 35, "Subsubsection"],
Cell[60497, 1548, 633, 14, 102, "Input"],
Cell[61133, 1564, 252, 7, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61422, 1576, 124, 1, 45, "Subsection"],
Cell[61549, 1579, 605, 11, 56, "Input"],
Cell[62157, 1592, 298, 6, 34, "Input"],
Cell[62458, 1600, 277, 8, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62772, 1613, 176, 2, 45, "Subsection"],
Cell[62951, 1617, 678, 13, 79, "Input"],
Cell[63632, 1632, 298, 6, 34, "Input"],
Cell[63933, 1640, 277, 8, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64247, 1653, 226, 3, 45, "Subsection"],
Cell[64476, 1658, 727, 14, 79, "Input"],
Cell[65206, 1674, 298, 6, 34, "Input"],
Cell[65507, 1682, 277, 8, 32, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65845, 1697, 102, 1, 66, "Chapter"],
Cell[65950, 1700, 320, 8, 34, "Input"],
Cell[66273, 1710, 256, 6, 34, "Input"],
Cell[66532, 1718, 149, 3, 32, "Input"],
Cell[66684, 1723, 274, 7, 32, "Input"],
Cell[66961, 1732, 231, 6, 32, "Input"],
Cell[67195, 1740, 199, 5, 34, "Input"]
}, Open  ]]
}
]
*)

